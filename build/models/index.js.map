{"version":3,"sources":["../../src/models/index.js"],"names":["dbURI","process","env","MONGOLAB_URI","connectDb","mongoose","connect","connection","on","console","log","err","warn","gracefulShutdown","msg","callback","close","once","kill","pid","exit","models","User","Budget"],"mappings":";;;;;;;AAAA;;AAEA;;AACA;;;;AAEA,IAAMA,KAAK,GAAGC,OAAO,CAACC,GAAR,CAAYC,YAA1B;;AACA,IAAMC,SAAS,GAAG,SAAZA,SAAY,GAAM;AACtB,SAAOC,qBAASC,OAAT,CAAiBL,OAAO,CAACC,GAAR,CAAYC,YAA7B,CAAP;AACD,CAFD;;;;AAIAE,qBAASE,UAAT,CAAoBC,EAApB,CAAuB,WAAvB,EAAoC,YAAM;AACtCC,EAAAA,OAAO,CAACC,GAAR,CAAY,2BAA2BV,KAAvC;AACH,CAFD;;AAGAK,qBAASE,UAAT,CAAoBC,EAApB,CAAuB,OAAvB,EAAgC,UAACG,GAAD,EAAS;AACrCF,EAAAA,OAAO,CAACG,IAAR,CAAa,qBAAqBD,GAAlC;AACH,CAFD;;AAGAN,qBAASE,UAAT,CAAoBC,EAApB,CAAuB,YAAvB,EAAqC,YAAM;AACvCC,EAAAA,OAAO,CAACC,GAAR,CAAY,uBAAZ;AACH,CAFD;;AAGA,IAAMG,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACC,GAAD,EAAMC,QAAN,EAAmB;AACxCV,uBAASE,UAAT,CAAoBS,KAApB,CAA0B,YAAM;AAC5BP,IAAAA,OAAO,CAACC,GAAR,CAAY,oCAAoCI,GAAhD;AACAC,IAAAA,QAAQ;AACX,GAHD;AAIH,CALD,C,CAMA;;;AACAd,OAAO,CAACgB,IAAR,CAAa,SAAb,EAAwB,YAAW;AAC/BJ,EAAAA,gBAAgB,CAAC,iBAAD,EAAoB,YAAW;AAC3CJ,IAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ;AACAT,IAAAA,OAAO,CAACiB,IAAR,CAAajB,OAAO,CAACkB,GAArB,EAA0B,SAA1B;AACH,GAHe,CAAhB;AAIH,CALD,E,CAMA;;AACAlB,OAAO,CAACO,EAAR,CAAW,QAAX,EAAqB,YAAW;AAC5BK,EAAAA,gBAAgB,CAAC,iBAAD,EAAoB,YAAW;AAC3CJ,IAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ;AACAT,IAAAA,OAAO,CAACmB,IAAR,CAAa,CAAb;AACH,GAHe,CAAhB;AAIH,CALD,E,CAMA;;AACAnB,OAAO,CAACO,EAAR,CAAW,SAAX,EAAsB,YAAW;AAC7BK,EAAAA,gBAAgB,CAAC,wBAAD,EAA2B,YAAW;AAClDJ,IAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ;AACAT,IAAAA,OAAO,CAACmB,IAAR,CAAa,CAAb;AACH,GAHe,CAAhB;AAIH,CALD;AAOA,IAAMC,MAAM,GAAG;AAAEC,EAAAA,IAAI,EAAJA,gBAAF;AAAQC,EAAAA,MAAM,EAANA;AAAR,CAAf;eAIeF,M","sourcesContent":["import mongoose from 'mongoose';\r\n\r\nimport User from './user';\r\nimport Budget from './budget';\r\n\r\nconst dbURI = process.env.MONGOLAB_URI;\r\nconst connectDb = () => {\r\n  return mongoose.connect(process.env.MONGOLAB_URI);\r\n};\r\n\r\nmongoose.connection.on('connected', () => {\r\n    console.log('Mongoose connected to ' + dbURI);\r\n});\r\nmongoose.connection.on('error', (err) => {\r\n    console.warn('Connection error' + err);\r\n});\r\nmongoose.connection.on('disconnect', () => {\r\n    console.log('Mongoose disconnected');\r\n});\r\nconst gracefulShutdown = (msg, callback) => {\r\n    mongoose.connection.close(() => {\r\n        console.log('Mongoose disconnected throught ' + msg);\r\n        callback();\r\n    });\r\n}\r\n// For nodemon restarts\r\nprocess.once('SIGUSR2', function() {\r\n    gracefulShutdown('nodemon restart', function() {\r\n        console.log(\"Disconnect....\");\r\n        process.kill(process.pid, 'SIGUSR2');\r\n    });\r\n});\r\n// For app termination\r\nprocess.on('SIGINT', function() {\r\n    gracefulShutdown('app termination', function() {\r\n        console.log(\"Disconnect....\");\r\n        process.exit(0);\r\n    });\r\n});\r\n// For Heroku app termination\r\nprocess.on('SIGTERM', function() {\r\n    gracefulShutdown('Heroku app termination', function() {\r\n        console.log(\"Disconnect....\");\r\n        process.exit(0);\r\n    });\r\n});\r\n\r\nconst models = { User, Budget };\r\n\r\nexport { connectDb };\r\n\r\nexport default models;"],"file":"index.js"}